var CONF={};CONF.REPEAT_INFINITE=-1,CONF.SLOW_SPEED=20,CONF.DEFAULT_SPEED=50,CONF.FAST_SPEED=80,CONF.SMALL_STEP=10,CONF.DEFAULT_STEP=15,CONF.LARGE_STEP=20,CONF.SMALL_SIZE=2,CONF.DEFAULT_SIZE=3,CONF.LARGE_SIZE=5,CONF.SMALL_FREQUENCY=5,CONF.DEFAULT_FREQUENCY=10,CONF.LARGE_FREQUENCY=15;var Hail=function(t){this.stop=!1,this.currentMousePos={x:$("body").width()/2,y:$("body").height()/2},this.leftOffset=0,this.step=CONF.DEFAULT_STEP,this.positionsY=[],this.rangeX=[],this.time=t.time?t.time:CONF.REPEAT_INFINITE,this.color=t.color?t.color:"white",this.speed=t.speed?t.speed:CONF.DEFAULT_SPEED,this.frequency=t.delay?t.frequency:CONF.DEFAULT_FREQUENCY,this.size=t.size?t.size:CONF.DEFAULT_SIZE,this.targets="object"==typeof t.targets?t.targets:[];var e=this;setTimeout(function(){requestAnimationFrame(function(){e.make(),e.mousePosition()})},0),e.time!=CONF.REPEAT_INFINITE&&setTimeout(function(){requestAnimationFrame(function(){e.destroy()})},e.time),e.targets&&(e.targets=e.getBlocks()),e.setPositions()};Hail.prototype.getRandom=function(t,e){return Math.floor(Math.random()*(e-t)+t)},Hail.prototype.make=function(){if(!this.stop){var t=this,e=$("<span />",{"class":"hail"}),i=t.getRandom(CONF.SMALL_STEP,CONF.LARGE_STEP);e.css({background:this.color}),e.css({left:t.getRandom(0,$("body").width())}),e.css({top:"-10px"}),e.css({height:this.size+"px",width:this.size+"px"}),setTimeout(function(){t.HandleInterval(t,e,i)},1e3/t.speed),$("body").append(e),setTimeout(function(){requestAnimationFrame(function(){t.make()})},1e3/this.frequency)}},Hail.prototype.HandleInterval=function(t,e,i){requestAnimationFrame(function(){var s=parseFloat(e.css("top")),o=parseFloat(e.css("left"));if(!t.settle(o,s)){if(s>=$("body").height()||0>o||o>$("body").width())return void e.remove();e.css({top:s+i+"px",left:o+t.leftOffset+"px"}),setTimeout(function(){t.HandleInterval(t,e,i)},1e3/t.speed)}})},Hail.prototype.destroy=function(){this.stop=!0},Hail.prototype.setPositions=function(){for(i=0;i<this.targets.length;i++){var t=$(this.targets[i]).offset(),e=t.top,s=t.left,o=t.left+$(this.targets[i]).width();this.positionsY.push(e);var n={min:s,max:o};this.rangeX.push(n)}},Hail.prototype.settle=function(t,e){if(index=$.inArray(e,this.positionsY),index>=0){var i=this.rangeX[index];if(t>=i.min&&t<=i.max)return!0}return!1},Hail.prototype.getBlocks=function(){var t=$("div:visible"),e=[],s=5;if(t.length<s)return t;for(i=0;e.length<s;i++){this.getRandom(0,t.length-1);$.inArray(t[i],e)||e.push(t[i])}return e},Hail.prototype.mousePosition=function(){var t=this;$(document).mousemove(function(e){e.pageX>t.currentMousePos.x?t.leftOffset=(e.pageX-t.currentMousePos.x)%($("body").width()/2):t.leftOffset=(e.pageX-t.currentMousePos.x)%($("body").width()/2),t.currentMousePos.x=e.pageX,t.currentMousePos.y=e.pageY})};